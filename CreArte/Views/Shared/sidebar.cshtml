@{
    Layout = null; // este parcial no usa layout propio

    // Controlador actual para marcar activo
    var currentController = (ViewContext.RouteData.Values["controller"]?.ToString() ?? "").ToLower();

    // Controladores hijos de "Configuración"
    var configChildren = new[] { "areas", "puestos", "niveles", "roles", "categorias", "empresa" };

    // Si estás dentro de alguno de estos controladores, el menú Configuración deberá mostrarse abierto
    bool isConfigOpen = configChildren.Contains(currentController);
}

<!-- Sidebar -->
<aside class="app-sidebar" id="sidebar">
    @* <div class="sidebar-title">Módulos</div> *@

    <!-- Items del menú -->
    <nav class="sidebar-nav">
        <!-- Caja -->
        <a asp-controller="Home" asp-action="Index"
           class="nav-item @(currentController == "home" ? "is-active" : "")">
            <i class="bi bi-cash-stack"></i> <span>Caja</span>
        </a>

        <!-- Ventas -->
        <a asp-controller="Ventas" asp-action="Index"
           class="nav-item @(currentController == "ventas" ? "is-active" : "")">
            <i class="bi bi-bag"></i> <span>Ventas</span>
        </a>

        <!-- Pedidos -->
        <a asp-controller="Pedidos" asp-action="Index"
           class="nav-item @(currentController == "pedidos" ? "is-active" : "")">
            <i class="bi bi-card-checklist"></i> <span>Pedidos</span>
        </a>

        <!-- Productos -->
        <a asp-controller="Productos" asp-action="Index"
           class="nav-item @(currentController == "productos" ? "is-active" : "")">
            <i class="bi bi-box"></i> <span>Productos</span>
        </a>

        <!-- Inventario -->
        <a asp-controller="Inventario" asp-action="Index"
           class="nav-item @(currentController == "inventario" ? "is-active" : "")">
            <i class="bi bi-stack"></i> <span>Inventario</span>
        </a>

        <!-- Compras -->
        <a asp-controller="Compras" asp-action="Index"
           class="nav-item @(currentController == "compras" ? "is-active" : "")">
            <i class="bi bi-basket"></i> <span>Compras</span>
        </a>

        <!-- Reportes -->
        <a asp-controller="Reportes" asp-action="Index"
           class="nav-item @(currentController == "reportes" ? "is-active" : "")">
            <i class="bi bi-graph-up"></i> <span>Reportes</span>
        </a>

        <div class="sidebar-sep"></div>

        <!-- Proveedores -->
        <a asp-controller="Proveedores" asp-action="Index"
           class="nav-item @(currentController == "proveedores" ? "is-active" : "")">
            <i class="bi bi-truck"></i> <span>Proveedores</span>
        </a>

        <!-- Clientes -->
        <a asp-controller="Clientes" asp-action="Index"
           class="nav-item @(currentController == "clientes" ? "is-active" : "")">
            <i class="bi bi-people"></i> <span>Clientes</span>
        </a>

        <!-- Empleados -->
        <a asp-controller="Empleados" asp-action="Index"
           class="nav-item @(currentController == "empleados" ? "is-active" : "")">
            <i class="bi bi-person-badge"></i> <span>Empleados</span>
        </a>

        @* <!-- Puestos -->
        <a asp-controller="Puestos" asp-action="Index"
           class="nav-item @(currentController == "puestos" ? "is-active" : "")">
            <i class="bi bi-diagram-3"></i> <span>Puestos</span>
        </a> *@

        <!-- Usuarios -->
        <a asp-controller="Usuarios" asp-action="Index"
           class="nav-item @(currentController == "usuarios" ? "is-active" : "")">
            <i class="bi bi-person-gear"></i> <span>Usuarios</span>
        </a>

        <div class="sidebar-sep"></div>

        <!-- PADRE: CONFIGURACIÓN (toggle con Bootstrap Collapse, SIN flecha) -->
        <a id="cfg-toggle"
           class="nav-item nav-item-toggle no-caret @(isConfigOpen ? "is-open" : "")"
           href="#cfg-sub" data-bs-toggle="collapse" role="button"
           aria-expanded="@(isConfigOpen.ToString().ToLower())"
           aria-controls="cfg-sub">
            <i class="bi bi-gear"></i> <span>Configuración</span>
        </a>

        <!-- ====== HIJOS: SUBMENÚ CONFIGURACIÓN ====== -->
        <div class="collapse nav-sub @(isConfigOpen ? "show" : "")" id="cfg-sub">

            <!-- Áreas -->
            <a asp-controller="Areas" asp-action="Index"
               class="nav-item nav-item--sub @(currentController == "areas" ? "is-active" : "")">
                <i class="bi bi-grid-3x3-gap"></i> <span>Áreas</span>
            </a>

            <!-- Puestos -->
            <a asp-controller="Puestos" asp-action="Index"
               class="nav-item nav-item--sub @(currentController == "puestos" ? "is-active" : "")">
                <i class="bi bi-diagram-3"></i> <span>Puestos</span>
            </a>

            <!-- Niveles -->
            <a asp-controller="Niveles" asp-action="Index"
               class="nav-item nav-item--sub @(currentController == "niveles" ? "is-active" : "")">
                <i class="bi bi-layers"></i> <span>Niveles</span>
            </a>

            <!-- Roles -->
            <a asp-controller="Roles" asp-action="Index"
               class="nav-item nav-item--sub @(currentController == "roles" ? "is-active" : "")">
                <i class="bi bi-shield-lock"></i> <span>Roles</span>
            </a>

            <!-- Categorías -->
            <a asp-controller="Categorias" asp-action="Index"
               class="nav-item nav-item--sub @(currentController == "categorias" ? "is-active" : "")">
                <i class="bi bi-tags"></i> <span>Categorías</span>
            </a>

            <!-- Empresa -->
            <a asp-controller="Empresa" asp-action="Index"
               class="nav-item nav-item--sub @(currentController == "empresa" ? "is-active" : "")">
                <i class="bi bi-building"></i> <span>Empresa</span>
            </a>
        </div>

    </nav>
</aside>
